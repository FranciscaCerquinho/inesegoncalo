{% import 'macros/contributions.html' as contributions %}
{% import 'macros/contributions.html' as contributions %}

{% macro product_card(product) %}
<div class="product-card">
    <a href="{{ url_for('products.product', product_id=product.id) }}">
        {% if product.images %}
        <div class="product-card-image">
            <img src="{{ url_for('static', filename=product.images[0].path) }}" alt="{{ product.name }}">
        </div>
        {% endif %}
        <div class="product-card-content">
            <h3 class="product-card-title">{{ product.name }}</h3>
            {% if product.description %}
            <p class="product-card-description">{{ product.description[:100] }}{% if product.description|length > 100 %}...{% endif %}</p>
            {% endif %}
            {% if product.show_price and product.price %}
            <div class="product-card-price">
                <span class="price-paid">€{{ "%.2f"|format(product.price_paid) }}</span>
                <span class="price-total"> / €{{ "%.2f"|format(product.price) }}</span>
            </div>
            <div class="product-card-progress">
                <div class="progress-bar" style="width: {{ product.calculate_percentage() }}%"></div>
            </div>
            {% endif %}
        </div>
    </a>
</div>
{% endmacro %}

{% macro category_card(category, is_selected=False) %}
<a href="{{ url_for('products.all', category_id=category.id) if not is_selected else url_for('products.all') }}" 
   class="category-card {% if is_selected %}category-card-selected{% endif %}">
    <div class="category-card-image">
        {% if category.images and category.images|length > 0 %}
        <img src="{{ url_for('static', filename=category.images[0].path) }}" alt="{{ category.name }}">
        {% else %}
        <div class="category-placeholder">
            <i class="fas fa-box"></i>
        </div>
        {% endif %}
    </div>
    <div class="category-card-title">
        <h4>{{ category.name }}</h4>
    </div>
</a>
{% endmacro %}


{% macro card(product1, product2) %}
    <!--first section-->
    <div class="row align-items-center how-it-works d-flex">
        <div class="col-2 text-center bottom d-inline-flex justify-content-center align-items-center">
        <div class="circle font-weight-bold">
            {% if product1.priority != 20 %}
            <a href="{{url_for('products.product',product_id=product1.id)}}">
                <i class="fas fa-map-marker-alt" style="color:white"></i> 
            </a>
            {% else %}
            <a>
                <i class="fas fa-map-marker-alt" style="color:white"></i> 
            </a>
            {% endif %}

        </div>
        </div>
        <div class="col-6">
            <h5>
                {% if product1.priority != 20 %}
                <a href="{{url_for('products.product',product_id=product1.id)}}" style="color:black"><h5>{{product1.name}}</h5></a>
                {% else %}
                <a style="color:black"><h5>{{product1.name}}</h5></a>
                {% endif %}

            </h5>
            {% if product1.priority == 20 %}
            <p>{{product1.description}}</p>
            {% endif %}
        </div>
    </div>
    {% if product2.priority != 20 %}

    <!--path between 1-2-->
    <div class="row timeline">
        <div class="col-2">
        <div class="corner top-right"></div>
        </div>
        <div class="col-8">
        <hr/>
        </div>
        <div class="col-2">
        <div class="corner left-bottom"></div>
        </div>
    </div>
    <!--second section-->
    <div class="row align-items-center justify-content-end how-it-works d-flex">
        <div class="col-6 text-right">
            <h5>
                <a href="{{url_for('products.product',product_id=product2.id)}}" style="color:black"><h5>{{product2.name}}</h5></a>

            </h5>
        </div>
        <div class="col-2 text-center full d-inline-flex justify-content-center align-items-center">
        <div class="circle font-weight-bold">
            <a href="{{url_for('products.product',product_id=product2.id)}}">
                <i class="fas fa-map-marker-alt" style="color:white"></i> 
            </a>
        </div>
        </div>
    </div>
    <!--path between 2-3-->
    <div class="row timeline">
        <div class="col-2">
        <div class="corner right-bottom"></div>
        </div>
        <div class="col-8">
        <hr/>
        </div>
        <div class="col-2">
        <div class="corner top-left"></div>
        </div>
    </div>
    {% endif %}
{% endmacro %}